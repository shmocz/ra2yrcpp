include_directories(${CMAKE_CURRENT_BINARY_DIR})
protobuf_generate_cpp(PROTO_SRCS PROTO_HDRS protocol/protocol.proto)
add_library(process STATIC process.cpp errors.cpp)
add_library(network STATIC network.cpp errors.cpp)
target_link_libraries(network ${LIB_WSOCK})
add_library(protocol STATIC protocol/protocol.cpp ${PROTO_SRCS} ${PROTO_HDRS})
target_link_libraries(protocol PUBLIC ${Protobuf_LIBRARIES})
target_include_directories(protocol PUBLIC ${Protobuf_INCLUDE_DIRS})
add_library(connection STATIC connection.cpp)
target_link_libraries(connection PUBLIC network)
add_library(instrumentation_service STATIC instrumentation_service.cpp server.cpp command_manager.cpp hook.cpp process.cpp commands_builtin.cpp util_string.cpp)
target_link_libraries(instrumentation_service PUBLIC protocol connection)
